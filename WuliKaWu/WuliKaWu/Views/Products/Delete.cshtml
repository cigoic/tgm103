

@{
    ViewData["Title"] = "Delete";
}


<div id="deleteProduct">
    <div class="container m-5 mb-2">
        @*表頭*@
        <div class="section-title-4 text-center mb-55" data-aos="fade-up" data-aos-delay="200">
            <h2>Delete Product</h2>
            <div class="section-title-4 text-center mb-50 mt-3" data-aos="fade-up" data-aos-delay="200">
                <h5>Make Sure Before You Click Delete Button!</h5>
            </div>
        </div>

        @*商品區塊*@
        <div class="compare-page-wrapper pb-50">
            <div class="container">
                <div class="row">
                    <div class="col-lg-12">
                        <!-- Content Start -->
                        <div class="compare-page-content-wrap">
                            <span class="compare-table table-responsive">
                                <table class="table table-bordered mb-0">
                                    <tbody>
                                        <tr>
                                            <td class="first-column col-3"></td>
                                            @*商品圖片*@
                                            <td class="product-list-img">
@*                                                <div class="col-5" v-for="item in product.pictures">
*@                                                <div class="col-5">
                                                    <img class="img-fluid" :src="product.pictures[0]" alt="Product Picture" multiple />
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="first-column">Name</td>
                                            <td class="title">{{product.productName}}</td>
                                        </tr>

                                        <tr>
                                            <td class="first-column">Color</td>
                                            <td class="pro-color">{{product.colorIds}}</td>
                                        </tr>

                                        <tr>
                                            <td class="first-column">Size</td>
                                            <td class="pro-stock">{{product.sizeId}}</td>
                                        </tr>

                                        <tr>
                                            <td class="first-column">Price</td>
                                            <td class="pro-price">${{product.price}}</td>
                                        </tr>

                                        <tr>
                                            <td class="first-column">Selling Price</td>
                                            <td class="pro-price">${{product.sellingPrice}}</td>

                                        <tr>
                                            <td class="first-column">Category</td>
                                            <td class="pro-stock">{{product.categoryId}}</td>
                                        </tr>

                                        <tr>
                                            <td class="first-column">Tag</td>
                                            <td class="pro-stock">{{product.tagIds}}</td>
                                        </tr>


                                    </tbody>
                                </table>
                        </div>
                    </div>
                    <!-- Content End -->
                </div>
            </div>
        </div>
    </div>


    <div class="row mb-30 ms-3">

        <div class="col-3 ms-5">
            <a href="/Products/Index" class="col-3">Back to List</a>
        </div>

        @*商品刪除按鍵*@
        <div class="col-7">
            <input type="hidden" />
            <button type="button" id="Delete" class="btn btn-danger" @@click="removeProduct(@ViewBag.id)">Delete</button>
        </div>

        <div class="col-1"></div>
    </div>

</div>

<script>

    let app = new Vue({
        
        el:"#deleteProduct",
        data: 
        {
            //product:[],
            product: {                    
                productName: "",
                price: "",
                categoryId: "",
                sizeId:"",
                colorIds:[],
                sellingPrice: "",
                tagIds: [],
                comment: "",
                pictures:[]
            },
            picPriview:[]
        },
        
        mounted: function(){
            var self = this;
            fetch('/api/product/getbyid/'+'@ViewBag.id')
            .then(function(response){return response.json()})
            .then(function(result){
                
                self.product = result;
                self.product.productId = @ViewBag.id
                
                console.log(result)
            })

        },

        methods:
        {
            getPictures: function()
            {
                var self = this;
                fetch('/api/picture/getall')
                .then(function(response){return response.json()})
                .then(function(result){
                    return product.pictures = result
                })
            },

            removeProduct: function(id)
            {
                var self = this;
                self.product.productId = @ViewBag.id
                fetch('/api/product/deletebyid/@ViewBag.id',{
                    method: "POST",
                    body:JSON.stringify(self.product.productId),
                    headers:{'content-type':'application/json'}

                })
                .then(function(response){return response.json()})
                .then(function(result){
                    var al = {
                        icon: 'success',
                        title: 'Delete Success!!!',
                        //text: result.message,
                        timer: 2000
                    };
                    if (!result.status) {
                        al.icon = "error";
                        al.title = "Delete Failed!!!";
                    }
                    Swal.fire(al)
                })
            }
        }
    
    })

</script>
