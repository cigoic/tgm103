<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
@*@model IEnumerable<ArticleModel>*@

=======
>>>>>>> [更新] 修正文章首頁
<div class="container" id="blogApp" />

<<<<<<< HEAD
=======
﻿
>>>>>>> [更新] 修改 _Layout 中 AboutUs, Blog...以及 Vue 的引用連結. 新增相關控制器與檢視頁面
=======
﻿@model ArticleModel
=======
﻿@model IEnumerable<ArticleModel>
>>>>>>> [更新] 部落格首頁可透過逐筆撈取資料庫,顯示文章及標題圖片(使用後端 Razoe syntax 寫法)
=======
﻿@*@model IEnumerable<ArticleModel>*@
<<<<<<< HEAD
>>>>>>> [更新] 部落格首頁改用 Vue.js 撈取資料庫文章資料(初版)
@{
    ViewBag.Title = "Our Blog";
}
=======
>>>>>>> [更新] 修正部落格首頁日期顯示與分頁

<div class="container" id="blogApp" />

>>>>>>> [更新] Blog Index 檢視可顯示單筆部落格文章與圖片
<div class="breadcrumb-area bg-gray-4 breadcrumb-padding-1">
    <div class="container">
        <div class="breadcrumb-content text-center">
            <h2 data-aos="fade-up" data-aos-delay="200">Blog</h2>
            <ul data-aos="fade-up" data-aos-delay="400">
<<<<<<< HEAD
<<<<<<< HEAD
                <li><a href="/Home/Index">Home</a></li>
=======
                <li><a asp-controller="Home" asp-action="Index">Home</a></li>
>>>>>>> [更新] 修改 _Layout 中 AboutUs, Blog...以及 Vue 的引用連結. 新增相關控制器與檢視頁面
=======
                <li><a href="/Home/Index">Home</a></li>
>>>>>>> [更新] 修正部落格首頁日期顯示與分頁
                <li><i class="ti-angle-right"></i></li>
                <li>Blog Standard </li>
            </ul>
        </div>
    </div>
    <div class="breadcrumb-img-1" data-aos="fade-right" data-aos-delay="200">
        <img src="~/assets/images/banner/breadcrumb-1.png" alt="">
    </div>
    <div class="breadcrumb-img-2" data-aos="fade-left" data-aos-delay="200">
        <img src="~/assets/images/banner/breadcrumb-2.png" alt="">
    </div>
</div>
<<<<<<< HEAD
<<<<<<< HEAD

=======
>>>>>>> [新增] 修改 Artical 資料內容類別定義表, 新增部落格發文功能, 將 CK Editor 純文字內容加入資料庫

<div class="blog-area pt-15 pb-100">
    <template>
        <div class="container">
            <div class="row">
                <div v-for="(article, index) in formattedArticles" :key="index" class="col-lg-4 col-md-6">
                    <div class="blog-wrap mb-50" data-aos="fade-up" :data-aos-delay="200+ 200*index">
                        <div class="blog-img-date-wrap mb-25">
                            <div class="blog-img">
<<<<<<< HEAD
                                <a href="/Blog/Details"><img src="/assets/images/blog/blog-details.png" alt=""></a>
<<<<<<< HEAD
=======
                                <a href="/Blog/Details"><img :src="article.titleImage" alt=""></a>
>>>>>>> [修正] 文章清單的標題影像顯示
                            </div>
                            <div class="blog-date">
                                <h5> {{ article.timeInDay }} <span>{{ article.timeInMonth }}</span></h5>
                            </div>
                        </div>

                        <div class="blog-content">
                            <h1>{{ article.title }}</h1>
                            <p v-html="article.description">{{ article.description }}</p>

                            <div class="blog-btn-2 btn-hover">
                                <a class="btn hover-border-radius theme-color" :href="articleLink(article.id)">Read More</a>
                                <a v-if="IsAuthorized" class="btn btn-primary hover-border-radius theme-color" style="background-color:cadetblue" :href="linkToEdit(article.id)">Edit</a>
                                @*<a class="btn btn-danger hover-border-radius theme-color" :href="linkToCreate(article.id)">Create</a>*@
                                <a v-if="IsAuthorized" class="btn btn-danger hover-border-radius theme-color" style="background-color:indianred" @@click="showConfirm(article.id)">Del</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            @*分頁*@
            <div class="pagination-style-1" data-aos="fade-up" data-aos-delay="200" :hidden="articles.length===0">
                @*<div id="loading" class="spinner-border center" role="status">
                <span class="visually-hidden">Loading...</span>
                </div>*@
                @*
                <ul>
                <li><a :class="{active:currentPage==n}" v-for="n in 10" href="#">{{n}}</a></li>
                <li><a class="next" href="#"><i class=" ti-angle-double-right "></i></a></li>
                </ul>
                *@
                <paginate :page-count="Math.ceil(articles.length/countPerPage)"
                          :page-range="10"
                          :margin-pages="1"
                          :click-handler="clickCallback"
                          :prev-text="'Prev'"
                          :next-text="'Next'"
                          :container-class="'pagination'"
                          :page-class="'page-item'">
                    <span v-if="articles.length > 1" slot="prevContent"><i class=" ti-angle-double-left "></i></span>
                    <span v-if="articles.length > 1" slot="nextContent"><i class=" ti-angle-double-right "></i></span>
                </paginate>
            </div>

        </div>
    </template>
</div>

@section Scripts{

    <script src="https://unpkg.com/vuejs-paginate@1.9.0"></script>
    <script>
        Vue.component('paginate', VuejsPaginate);

        let blogVue = new Vue({
            //el:'#blogApp',
            name: "blogApp",
            data: {
                articles: [],
                //visibleArticles: [],
                articleBaseLink: "/Blog/Details/",
                currentPage: 1,
                countPerPage: 3,
                IsAuthorized: false,
                //currentIndex: 0,
            },
            created() {
                axios.get("/api/Blog/GetLoginStatus")
                    .then(response => { this.IsAuthorized = response.data; })
                    .catch(error => { tgm103ShowError(error); });

                this.getArticles()
            },
            mounted: function () {
                var self = this;

                //const options = {
                //    threshold: 0.25
                //};
                //var load = document.getElementById("loading")
                //var ob = new IntersectionObserver(function () {
                //    self.currentIndex++;
                //    self.visibleArticles.push(self.articles[self.currentIndex])
                //    //self.getData()
                //}, options)
                //ob.observe(load);
            },
            computed: {
                filterArticles: function () {
                    var min = this.countPerPage * (this.currentPage - 1 <= 0 ? 0 : this.currentPage - 1);
                    var max = this.countPerPage * this.currentPage;
                    this.min = min;
                    this.max = max;
                    return this.articles.slice(min, max)
                },
                formattedArticles() {
                    return this.filterArticles.map(article => {
                        const date = new Date(article.modifiedDate);
                        return {
                            ...article,
                            timeInDay: `${date.getDate()}`,
                            timeInMonth: `${date.toLocaleString('default', { month: 'short' })}` //`${this.getMonthName(date.getMonth())}`
                        };
                    });
                }
            },
            methods: {
                clickCallback: function (page) {
                    this.currentPage = page;
                },
                articleLink: function (articleId) {
                    return this.articleBaseLink + articleId
                },
                linkToEdit: function (id) {
                    const queryEditBaseLink = "/Blog/Edit/" + id
                    return queryEditBaseLink
                },
                linkToCreate: function (id) {
                    const queryCreateBaseLink = "/Blog/Create"
                    return queryCreateBaseLink
                },
                getArticles: async function () {
                    await axios.get("/api/Blog/GetArticles")
                        .then(response => {
                            console.log("at created, article response:", response)
                            if (response.status == 200 && response.data.statusCode === 200) {
                                this.articles = response.data.value
                                //this.visibleArticles = this.articles.slice(0, this.countPerPage);
                                console.log("articles:", this.articles)
                            }
                        })
                        .catch(error => { tgm103ShowError(error.response.data) })
                },
                delArticle: function (id) {
                    console.log("del article id:", id)
                    const queryDelBaseUrl = '/api/Blog/Delete/' + id
                    axios.get(queryDelBaseUrl)
                        .then(response => {
                            console.log("del article response:", response)
                            //if (response.status === 200 && response.data.statusCode == 200)
                            tgm103ShowSuccess(response.data.value.message)
                            window.location = "/Blog"
                        })
                        .catch(error => {
                            console.log("del article error:", error)
                            tgm103ShowError(error.response.data.value.message)
                        })
                },
                showConfirm(id) {
                    Swal.fire({
                        title: "確定刪除嗎??",
                        text: "此動作不可逆!",
                        icon: "warning",
                        showCancelButton: true,
                        confirmButtonColor: "#3085d6",
                        cancelButtonColor: "#d33",
                        confirmButtonText: "是的, 刪除!",
                        cancelButtonText: "不，再考慮"
                    }).then((result) => {
                        if (result.value) {
                            // Perform the action if the user confirms
                            this.delArticle(id)
                        }
                    });
                },
            },
        })

        document.addEventListener("DOMContentLoaded", () => {
            blogVue.$mount('#blogApp')
        })
    </script>
}
=======
=======


>>>>>>> [更新] 部落格首頁改用 Vue.js 撈取資料庫文章資料(初版)
<div class="blog-area pt-100 pb-100">
    <div class="container">
        <div class="row">
            @*=========== Vue.js 寫法 ==========================================================(開始)*@
            <template v-for="article in filterArticles" :key="article.id">
                <div class="col-lg-4 col-md-6">
                    <div class="blog-wrap mb-50" data-aos="fade-up" data-aos-delay="200">
                        <div class="blog-img-date-wrap mb-25">
                            <div class="blog-img">
                                <a href="/Blog/Details"><img src="~/assets/images/blog/blog-details.png" alt=""></a>
=======
>>>>>>> [更新] 調整會員登入使用 ClaimsType.Sid, RoleType 使用 Description 描述, 以及登入頁面
                            </div>
                            <div class="blog-date">
                                <h5 v-if="articleDay(article.modifiedDate)"> {{ aDay }} <span v-if="getMonthName(article.modifiedDate)">{{ aMonth }}</span></h5>
                            </div>
                        </div>
                        <div class="blog-content">
                            <h1>{{ article.title }}</h1>
                            <p>{{ article.content }}</p>

                            <div class="blog-btn-2 btn-hover">
                                <a class="btn hover-border-radius theme-color" :href="articleLink(article.articleId)">Read More</a>
                            </div>
                        </div>
                    </div>
                </div>
            </template>
            @*=========== Vue.js 寫法 ==========================================================(結束)*@

            @*=========== Razor 寫法 ==========================================================(開始)
            @foreach(var item in @Model)
            {
<<<<<<< HEAD
                <div class="col-lg-4 col-md-6">
                    <div class="blog-wrap mb-50" data-aos="fade-up" data-aos-delay="200">
                        <div class="blog-img-date-wrap mb-25">
                            <div class="blog-img">
                                <a asp-controller="Blog" asp-action="Details"><img src="@item.FileName" alt=""></a>
                            </div>
                            <div class="blog-date">
                                <h5>05 <span>May</span></h5>
                            </div>
                        </div>
<<<<<<< HEAD
                        <h3><a asp-controller="Blog" asp-action="Details">@item.Title</a></h3>
                        <p>@item.Content</p>
                        <div class="blog-btn-2 btn-hover">
                            <a class="btn hover-border-radius theme-color" asp-controller="Blog" asp-action="Details">Read More</a>
=======
                        <div class="blog-content">
                            <div class="blog-meta">
                                <ul>
                                    <li><a href="#">Furniture</a>,</li>
                                    <li>By:<a href="#">@item.MemberName</a></li>
                                </ul>
                            </div>
=======
            <div class="col-lg-4 col-md-6">
            <div class="blog-wrap mb-50" data-aos="fade-up" data-aos-delay="200">
            <div class="blog-img-date-wrap mb-25">
            <div class="blog-img">
            <a asp-controller="Blog" asp-action="Details"><img src="@item.FileName" alt=""></a>
            </div>
            <div class="blog-date">
            <h5>05 <span>May</span></h5>
            </div>
            </div>
            <div class="blog-content">
            <div class="blog-meta">
            <ul>
            <li><a href="#">Furniture</a>,</li>
            <li>By:<a href="#">@item.MemberName</a></li>
            </ul>
            </div>
>>>>>>> [更新] 部落格首頁、內容檢視頁面跳轉頁面（如：上下一筆文章、當前文章）的超連結邏輯

            <h3><a asp-controller="Blog" asp-action="Details">@item.Title</a></h3>

<<<<<<< HEAD
                            <p>@item.Content</p>
                            <div class="blog-btn-2 btn-hover">
                                <a class="btn hover-border-radius theme-color" asp-controller="Blog" asp-action="Details">Read More</a>
                            </div>
>>>>>>> [更新] 部落格首頁改用 Vue.js 撈取資料庫文章資料(初版)
                        </div>
                    </div>
                </div>
=======
            <p>@item.Content</p>
            <div class="blog-btn-2 btn-hover">
            <a class="btn hover-border-radius theme-color" asp-controller="Blog" asp-action="Details">Read More</a>
            </div>
            </div>
            </div>
            </div>
>>>>>>> [更新] 部落格首頁、內容檢視頁面跳轉頁面（如：上下一筆文章、當前文章）的超連結邏輯
            }
            @*=========== Razor 寫法 ==========================================================(結束)*@
        </div>

        @*分頁*@
        <div class="pagination-style-1" data-aos="fade-up" data-aos-delay="200">
            @*
            <ul>
            <li><a :class="{active:currentPage==n}" v-for="n in 10" href="#">{{n}}</a></li>
            <li><a class="next" href="#"><i class=" ti-angle-double-right "></i></a></li>
            </ul>
            *@

            <paginate :page-count="Math.ceil(articles.length/countPerPage)"
                      :page-range="10"
                      :margin-pages="1"
                      :click-handler="clickCallback"
                      :prev-text="'Prev'"
                      :next-text="'Next'"
                      :container-class="'pagination'"
                      :page-class="'page-item'">
                <span slot="prevContent"><i class=" ti-angle-double-left "></i></span>
                <span slot="nextContent"><i class=" ti-angle-double-right "></i></span>
            </paginate>

        </div>
    </div>
</div>
<<<<<<< HEAD
>>>>>>> [更新] 修改 _Layout 中 AboutUs, Blog...以及 Vue 的引用連結. 新增相關控制器與檢視頁面
=======

@section Scripts{

    <script src="https://unpkg.com/vuejs-paginate@1.9.0"></script>
    @*<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.2.6/axios.min.js" integrity="sha512-RUkwGPgBmjCwqXpCRzpPPmGl0LSFp9v5wXtmG41+OS8vnmXybQX5qiG5adrIhtO03irWCXl+z0Jrst6qeaLDtQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>*@
    <script>
        Vue.component('paginate', VuejsPaginate);

        let blogVue = new Vue({
            //el:'#blogApp',
            name: "blogApp",
            data: {
                articles: [
                    {
                        id: 1,
                        title: '文章 1',
                        content: '接到民國手指全球最後，承諾汽車，手段經濟發展意外有所原來模型的人未經接着，我有玩家積極負責一遍開放男子利潤，治理免費都是詢問尤其一週社會主義模擬學科一場趕緊圖書的話，臺灣消失比例上一頁驚人至今新臺幣刪除等方面一路適當產權頻率，複雜那就那個還沒有，由於突出。',
                        createdAt: '2022-01-01'
                    },
                    {
                        id: 2,
                        title: '文章 2',
                        content: '身邊本書本書職工用戶名，鈴聲付出領域心理都說施工運動競爭鈴聲下載，地面從來沒以前學者英雄動畫員工校長文學你們的承受吸收模型用戶名，領先隊員一遍打開推薦使用私人想起有一種傳來擁有，緊緊你可以婚姻超級下載次數飯店，正在夫妻，點頭材料主角需求英文，宅宅許可，近。',
                        createdAt: '2022-01-02'
                    },
                    {
                        id: 3,
                        title: '文章 3',
                        content: '碩士試驗說過高達一家我不只好貢獻前來人大指出，以外所謂返回不良情感，帶來有點遠無門朋友提升交換，金幣前面見過拍攝紅色採取主演物業不用這次高校眼中，體會許可別人如下加速怎麼會，信用姑娘群發，競爭力程式老師博士，你還演唱生意，詳細內容日誌下去，您現在難道，供。',
                        createdAt: '2022-01-03'
                    }
                ],
                //articleBaseLink: "/api/Blog/GetArticleById/",
                articleBaseLink: "/Blog/Details/",
                currentPage: 1,
                countPerPage: 2,
                aDay: null,
                aMonth: null,
            },
            mounted: function () {
                var self = this;
                fetch('/api/Blog/GetArticles')
                    .then(function (response) { return response.json() })
                    .then(function (result) {
                        console.log(result);
                        self.articles = result;
                    })
                //axios
                //    .get('/api/Blog/GetArticles')
                //    .then(response => (self.articles = response.data))
                //    .catch(error => console.log(error))
            },
            computed: {
                filterArticles: function () {
                    var min = this.countPerPage * (this.currentPage - 1 <= 0 ? 0 : this.currentPage - 1);
                    var max = this.countPerPage * this.currentPage;
                    this.min = min;
                    this.max = max;
                    return this.articles.slice(min, max)
                },
            },
            methods: {
                clickCallback: function (page) {
                    this.currentPage = page;
                    console.log(page)
                },
                articleLink(articleId) {
                    return this.articleBaseLink + articleId
                },
                articleDay(currentDate) {
                    var date = new Date(currentDate);
                    this.aDay = date.getDate()
                    return this.aDay
                },
                getMonthName(currentDate) {
                    const date = new Date(currentDate)
                    this.aMonth = date.toLocaleString('default', { month: 'short' })
                    return this.aMonth
                },
            },
        })

        document.addEventListener("DOMContentLoaded", () => {
            blogVue.$mount('#blogApp')
        })
    </script>
}
>>>>>>> [更新] Blog Index 檢視可顯示單筆部落格文章與圖片
